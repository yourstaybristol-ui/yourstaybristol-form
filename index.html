<script>
  const params = new URLSearchParams(window.location.search);

  // Prefill existing fields
  document.getElementById('paymentAmount').value = params.get('paymentAmount') || '';
  document.getElementById('guestName').value = params.get('guestName') || '';
  document.getElementById('bookingRef').value = params.get('bookingRef') || '';

  // Conditional Source + Source Ref
  if (params.has('source')) {
    const form = document.querySelector('form');
    const note = document.getElementById('note');

    // Use the source value directly in the label
    const sourceName = params.get('source');

    const sourceRow = document.createElement('div');
    sourceRow.className = 'form-row';

    const sourceLabel = document.createElement('label');
    sourceLabel.setAttribute('for', 'sourceRef');
    sourceLabel.textContent = sourceName + ' Ref:';

    const sourceWrapper = document.createElement('div');
    sourceWrapper.className = 'input-wrapper';

    const sourceInput = document.createElement('input');
    sourceInput.type = 'text';
    sourceInput.id = 'sourceRef';
    sourceInput.value = params.get('sourceRef') || '';
    sourceInput.readOnly = true;

    sourceWrapper.appendChild(sourceInput);
    sourceRow.appendChild(sourceLabel);
    sourceRow.appendChild(sourceWrapper);

    form.insertBefore(sourceRow, note);
  }
</script>